ires_at&user_id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2&order=created_at.asc "HTTP/2 200 OK"        
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_meta_memory?select=adaptation_patterns%2Clearning_velocity%2Csuccess_predictors%2Cfailure_patterns%2Cagent_effectiveness%2Cconfidence_level%2Clast_updated&user_id=eq.%2735pDPUIfAoRl2Y700&order=confidence_level.asc "HTTP/2 200 OK"
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_analysis_results?select=id%2Cuser_id%2Canalysis_type%2Canalysis_result%2Carchetype%2Ccreated_at&user_id=eq.%2735pDPUIfAoRl2Y700&order=created_at.asc "HTTP/2 200 OK"
INFO:httpx:HTTP Request: POST https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_working_memory "HTTP/2 201 Created"
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/profiles?select=last_analysis_at&id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2 "HTTP/2 200 OK"
ERROR:shared_libs.database.connection_pool:Unexpected error during pool initialization: [Errno 11001] getaddrinfo failed
ERROR:shared_libs.supabase_client.adapter:Connection failed: Failed to create database pool: [Errno 11001] getaddrinfo failed
WARNING:shared_libs.supabase_client.adapter:üîÑ Database pool failed, falling back to Supabase REST API only
INFO:shared_libs.supabase_client.adapter:‚úÖ Fallback to Supabase REST API successful
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/scores?select=%2A&profile_id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2&created_at=gte.2025-08-19T18%3A04%3A11.097175%2B00%3A00&order=created_at.desc&limit=1000 "HTTP/2 200 OK"
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/biomarkers?select=%2A&profile_id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2&created_at=gte.2025-08-19T18%3A04%3A11.097175%2B00%3A00&order=created_at.desc&limit=1000 "HTTP/2 200 OK"
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/archetypes?select=id%2Cprofile_id%2Cname%2Cperiodicity%2Cvalue%2Cdata%2Cstart_date_time%2Cend_date_time%2Ccreated_at%2Cupdated_at&profile_id=eq.%2735pDPUIfAoRl2Y700 "HTTP/2 200 OK"
ERROR:shared_libs.supabase_client.adapter:Query fetch failed: Invalid non-printable ASCII character in URL, '\n' at position 7.
ERROR:services.user_data_service:[STALE_CHECK] Failed to get actual latest timestamp: Invalid non-printable ASCII character in URL, '\n' at position 7.
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/profiles?select=analysis_metadata&id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2 "HTTP/2 200 OK"
INFO:httpx:HTTP Request: PATCH https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/profiles?id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2 "HTTP/2 200 OK"
ERROR:shared_libs.database.connection_pool:Unexpected error during pool initialization: [Errno 11001] getaddrinfo failed
ERROR:shared_libs.supabase_client.adapter:Connection failed: Failed to create database pool: [Errno 11001] getaddrinfo failed
WARNING:shared_libs.supabase_client.adapter:üîÑ Database pool failed, falling back to Supabase REST API only
INFO:shared_libs.supabase_client.adapter:‚úÖ Fallback to Supabase REST API successful
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_longterm_memory?select=user_id%2Cmemory_category%2Cmemory_data%2Cconfidence_score%2Ccreated_at%2Clast_updated&user_id=eq.%2735pDPUIfAoRl2Y700&order=confidence_score.asc "HTTP/2 200 OK"     
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_shortterm_memory?select=user_id%2Cmemory_category%2Ccontent%2Cconfidence_score%2Ccreated_at%2Cexpires_at&user_id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2&order=created_at.asc "HTTP/2 200 OK"        
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_meta_memory?select=adaptation_patterns%2Clearning_velocity%2Csuccess_predictors%2Cfailure_patterns%2Cagent_effectiveness%2Cconfidence_level%2Clast_updated&user_id=eq.%2735pDPUIfAoRl2Y700&order=confidence_level.asc "HTTP/2 200 OK"
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_working_memory?select=user_id%2Csession_id%2Cagent_id%2Cmemory_type%2Ccontent%2Cpriority%2Ccreated_at%2Cexpires_at&user_id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2&is_active=eq.true&order=created_at.asc "HTTP/2 200 OK"
ERROR:shared_libs.database.connection_pool:Unexpected error during pool initialization: [Errno 11001] getaddrinfo failed
INFO:httpx:HTTP Request: GET https://api.openai.com/v1/models "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_analysis_results "HTTP/2 201 Created"
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/archetype_analysis_tracking?select=analysis_count&user_id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2&archetype=eq.Peak+Performer "HTTP/2 200 OK"
INFO:httpx:HTTP Request: POST https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/archetype_analysis_tracking "HTTP/2 201 Created"
INFO:services.archetype_analysis_tracker:[ARCHETYPE_TRACKER] Created new tracking for 35pDPUIfAoRl2Y700bFkxPKYjjf2 + Peak Performer
INFO:services.agents.memory.holistic_memory_service:[MEMORY_SERVICE] Updated archetype tracking: 35pDPUIfAoRl2Y700bFkxPKYjjf2 + Peak Performer
INFO:httpx:HTTP Request: POST https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_insights "HTTP/2 201 Created"
INFO:httpx:HTTP Request: POST https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_insights "HTTP/2 201 Created"
INFO:httpx:HTTP Request: POST https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_insights "HTTP/2 201 Created"
INFO:httpx:HTTP Request: POST https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_insights "HTTP/2 201 Created"
‚úÖ [INSIGHTS_LOGGER] Successfully logged 4 insights (Analysis #1)
   üìÑ Added to: logs/output_1.txt
   üìã Created: logs/insights_1.txt
INFO:services.insights_extraction_service:Extracted and stored 4 insights from behavior_analysis
INFO:httpx:HTTP Request: POST https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_shortterm_memory "HTTP/2 201 Created"
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_longterm_memory?select=id&user_id=eq.%2735pDPUIfAoRl2Y700bFkxPKYjj "HTTP/2 200 OK"
INFO:httpx:HTTP Request: POST https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_longterm_memory "HTTP/2 409 Conflict"
ERROR:shared_libs.supabase_client.adapter:Query execution failed: {'message': 'duplicate key value violates unique constraint "unique_user_memory_category"', 'code': '23505', 'hint': None, 'details': None}
ERROR:shared_libs.supabase_client.adapter:Query:
                    INSERT INTO holistic_longterm_memory (
                        user_id, memory_category, memory_data, confidence_score,
                        created_at, last_updated, update_source
                    ) VALUES ($1, $2, $3, $4, $5, $6, $7)

ERROR:shared_libs.supabase_client.adapter:Args: ('35pDPUIfAoRl2Y700bFkxPKYjjf2', 'behavioral_patterns', '{"_raw_analysis": {"behavioral_signature": {"signature": "Current data set shows a complete absence of recent tracking\\u2014no activity sessions, sleep cycles, or biomarker measurements were recorded for 2025-08-18 to 2025-08-19. For a Peak Performer archetype, this suggests one of two behavioral patterns: (1) the user is in initial onboarding and has not yet configured data collection devices/apps, or (2) there is a lapse in syncing/recording despite a likely intention to capture metrics. Either way, the dominant pattern is a data-void rather than a performance pattern.", "confidence": 0.25}, "sophistication_assessment": {"score": 25, "category": "Beginner", "justification": "Although the Peak Performer archetype typically operates at an advanced level, the user currently demonstrates no measurable engagement with data capture. Without reliable metrics, practical health-optimization behaviors cannot yet be confirmed, placing the functional sophistication of their tracking workflow at a beginner level."}, "primary_goal": {"goal": "Establish a reliable, high-fidelity baseline data stream for activity, sleep, and biomarkers to enable advanced performance optimization.", "timeline": "First 14 days (onboarding & stabilization)", "success_metrics": "\\u226590 % daily data coverage across steps/heart-rate, \\u22655 nights of validated sleep data per week, completion of one baseline biomarker panel (or at least HRV, RHR, morning glucose) within the first month."}, "personalized_strategy": {"motivation_drivers": "Appeal to the Peak Performer\\u2019s love of objective metrics and measurable progress\\u2014position baseline creation as the \\u2018foundation dataset\\u2019 required for all future optimization experiments.", "habit_integration": "Integrate device-sync checks into existing morning/evening routines (e.g., while making coffee, confirm wearables are synced; during evening wind-down, verify that sleep mode is activated). Use calendar or task-manager reminders for the first two weeks until the behavior becomes automatic.", "barrier_mitigation": "1) Technical friction: Provide step-by-step device/app setup guides and automated cloud-backup to avoid lost data. 2) Forgetting to wear devices: Place wearable on phone-charger stand overnight so it\\u2019s encountered with morning phone pickup. 3) Data overwhelm: Limit initial dashboard to three core metrics (sleep duration, HRV, subjective energy) to prevent paralysis."}, "readiness_level": "Medium", "recommendations": ["Complete device/app setup: ensure smartwatch or fitness tracker, sleep sensor, and at least one biomarker-friendly service (e.g., at-home lab or continuous glucose monitor) are connected to HolisticOS within 48 h.", "Perform a 24-h syncing test: verify that activity, heart-rate, and sleep data populate the dashboard; address any gaps immediately.", "Schedule a baseline blood/biomarker panel (or at minimum HRV, resting heart rate, fasting glucose) within the next two weeks.", "Enable automatic data-quality alerts in HolisticOS so missed data >12 h triggers a push notification.", "Assign a weekly \\u2018data hygiene\\u2019 review (10 min Sunday evening) to confirm completeness and annotate any anomalies (travel, illness, device off-wrist).", "After two weeks of \\u226590 % coverage, transition to performance-oriented protocols (sleep-cycle rescheduling, zone-2 endurance blocks, nutrition timing) based on the collected baseline."], "data_insights": "No current physiological or behavioral patterns can be extracted because the dataset is empty and classified as DataQualityLevel.POOR. The immediate insight is the critical importance of closing the data gap\\u2014without which the Peak Performer\\u2019s optimization instincts cannot be productively harnessed. Resolving technical or behavioral obstacles to continuous tracking is therefore the top priority.", "model_used": "o3", "analysis_type": "comprehensive_behavior"}, "_extraction_timestamp": "2025-08-19T18:39:31.408679+00:00", "_analysis_type": "behavior_analysis", "_source_model": "o3", "behavioral_signature": "Current data set shows a complete absence of recent tracking\\u2014no activity sessions, sleep cycles, or biomarker measurements were recorded for 2025-08-18 to 2025-08-19. For a Peak Performer archetype, this suggests one of two behavioral patterns: (1) the user is in initial onboarding and has not yet configured data collection devices/apps, or (2) there is a lapse in syncing/recording despite a likely intention to capture metrics. Either way, the dominant pattern is a data-void rather than a performance pattern.", "signature_confidence": 0.25, "recommendations": ["Complete device/app setup: ensure smartwatch or fitness tracker, sleep sensor, and at least one biomarker-friendly service (e.g., at-home lab or continuous glucose monitor) are connected to HolisticOS within 48 h.", "Perform a 24-h syncing test: verify that activity, heart-rate, and sleep data populate the dashboard; address any gaps immediately.", "Schedule a baseline blood/biomarker panel (or at minimum HRV, resting heart rate, fasting glucose) within the next two weeks.", "Enable automatic data-quality alerts in HolisticOS so missed data >12 h triggers a push notification.", "Assign a weekly \\u2018data hygiene\\u2019 review (10 min Sunday evening) to confirm completeness and annotate any anomalies (travel, illness, device off-wrist).", "After two weeks of \\u226590 % coverage, transition to performance-oriented protocols (sleep-cycle rescheduling, zone-2 endurance blocks, nutrition timing) based on the collected baseline."], "recommendation_count": 6, "primary_goal": {"goal": "Establish a reliable, high-fidelity baseline data stream for activity, sleep, and biomarkers to enable advanced performance optimization.", "timeline": "First 14 days (onboarding & stabilization)", "success_metrics": "\\u226590 % daily data coverage across steps/heart-rate, \\u22655 nights of validated sleep data per week, completion of one baseline biomarker panel (or at least HRV, RHR, morning glucose) within the first month."}, "personalized_strategy": {"motivation_drivers": "Appeal to the Peak Performer\\u2019s love of objective metrics and measurable progress\\u2014position baseline creation as the \\u2018foundation dataset\\u2019 required for all future optimization experiments.", "habit_integration": "Integrate device-sync checks into existing morning/evening routines (e.g., while making coffee, confirm wearables are synced; during evening wind-down, verify that sleep mode is activated). Use calendar or task-manager reminders for the first two weeks until the behavior becomes automatic.", "barrier_mitigation": "1) Technical friction: Provide step-by-step device/app setup guides and automated cloud-backup to avoid lost data. 2) Forgetting to wear devices: Place wearable on phone-charger stand overnight so it\\u2019s encountered with morning phone pickup. 3) Data overwhelm: Limit initial dashboard to three core metrics (sleep duration, HRV, subjective energy) to prevent paralysis."}, "readiness_level": "Medium", "sophistication_assessment": {"score": 25, "category": "Beginner", "justification": "Although the Peak Performer archetype typically operates at an advanced level, the user currently demonstrates no measurable engagement with data capture. Without reliable metrics, practical health-optimization behaviors cannot yet be confirmed, placing the functional sophistication of their tracking workflow at a beginner level."}, "data_insights": "No current physiological or behavioral patterns can be extracted because the dataset is empty and classified as DataQualityLevel.POOR. The immediate insight is the critical importance of closing the data gap\\u2014without which the Peak Performer\\u2019s optimization instincts cannot be productively harnessed. Resolving technical or behavioral obstacles to continuous tracking is therefore the top priority."}', 0.8, datetime.datetime(2025, 8, 19, 18, 39, 31, 531777, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 8, 19, 18, 39, 31, 531777, tzinfo=datetime.timezone.utc), 'memory_service')
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_meta_memory?select=id&user_id=eq.%273 "HTTP/2 200 OK"
INFO:httpx:HTTP Request: POST https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_meta_memory "HTTP/2 409 Conflict"
ERROR:shared_libs.supabase_client.adapter:Query execution failed: {'message': 'duplicate key value violates unique constraint "unique_user_meta_memory"', 'code': '23505', 'hint': None, 'details': None}
ERROR:shared_libs.supabase_client.adapter:Query:
                    INSERT INTO holistic_meta_memory (
                        user_id, adaptation_patterns, learning_velocity, success_predictors,
                        failure_patterns, agent_effectiveness, archetype_evolution, engagement_patterns,
                        created_at, last_updated, analysis_window_start, analysis_window_end
                    ) VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)
                    ON CONFLICT (user_id) DO UPDATE SET
                        adaptation_patterns = EXCLUDED.adaptation_patterns,
                        learning_velocity = EXCLUDED.learning_velocity,
                        last_updated = EXCLUDED.last_updated,
                        analysis_window_end = EXCLUDED.analysis_window_end

ERROR:shared_libs.supabase_client.adapter:Args: ('35pDPUIfAoRl2Y700bFkxPKYjjf2', '{"agents_used": ["behavior_analysis", "nutrition_plan", "routine_plan"], "complexity_provided": "low", "personalization_level": "low", "analysis_timestamp": "2025-08-19T18:39:31.667124+00:00"}', '{"analysis_frequency": "regular", "adaptation_speed": "moderate", "retention_indicators": {}}', '{}', '{}', '{}', '{}', '{}', datetime.datetime(2025, 8, 19, 18, 39, 31, 667140, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 8, 19, 18, 39, 31, 667140, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 7, 20, 18, 39, 31, 667140, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 8, 19, 18, 39, 31, 667140, tzinfo=datetime.timezone.utc))     
üîí [RACE_CONDITION_FIX] Added OnDemand metadata to behavior analysis result
INFO:services.api_gateway.openai_main:[SHARED_ANALYSIS] 35pDPUIf... Fresh analysis completed
‚ö†Ô∏è [BEHAVIOR_ANALYZE] Fresh analysis failed, attempting cached...
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_analysis_results?select=id%2Cuser_id%2Canalysis_type%2Canalysis_result%2Carchetype%2Ccreated_at&user_id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2&analysis_type=eq.%27behavior&order=created_at.asc "HTTP/2 200 OK"
INFO:services.ondemand_analysis_service:[ONDEMAND] No cached analysis found for archetype 'Peak Performer' for user 35pDPUIf
WARNING:shared_libs.rate_limiting.middleware:Slow request: POST /api/user/35pDPUIfAoRl2Y700bFkxPKYjjf2/behavior/analyze took 35.94s
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/archetype_analysis_tracking?select=last_analysis_at&user_id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2&archetype=eq.Peak+Performer "HTTP/2 200 OK"
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/scores?select=id&profile_id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2&created_at=gte.2025-08-19T18%3A39%3A29.431227%2B00%3A00 "HTTP/2 200 OK"
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/biomarkers?select=id&profile_id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2&created_at=gte.2025-08-19T18%3A39%3A29.431227%2B00%3A00 "HTTP/2 200 OK"
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_longterm_memory?select=user_id%2Cmemory_category%2Cmemory_data%2Cconfidence_score%2Ccreated_at%2Clast_updated&user_id=eq.%2735pDPUIfAoRl2Y700&order=confidence_score.asc "HTTP/2 200 OK"     
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_analysis_results?select=id%2Cuser_id%2Canalysis_type%2Canalysis_result%2Carchetype%2Ccreated_at&user_id=eq.%2735pDPUIfAoRl2Y700&order=created_at.asc "HTTP/2 200 OK"
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_meta_memory?select=adaptation_patterns%2Clearning_velocity%2Csuccess_predictors%2Cfailure_patterns%2Cagent_effectiveness%2Cconfidence_level%2Clast_updated&user_id=eq.%2735pDPUIfAoRl2Y700&order=confidence_level.asc "HTTP/2 200 OK"
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_analysis_results?select=id%2Cuser_id%2Canalysis_type%2Canalysis_result%2Carchetype%2Ccreated_at&user_id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2&analysis_type=eq.%27behavior&order=created_at.asc "HTTP/2 200 OK"
INFO:services.ondemand_analysis_service:[ONDEMAND] No cached analysis found for archetype 'Peak Performer' for user 35pDPUIf
‚ùå [THRESHOLD_DEBUG] No cached analysis found - falling back to fresh
WARNING:services.api_gateway.openai_main:[SHARED_ANALYSIS] 35pDPUIf... Cache failed, using fresh
ERROR:shared_libs.database.connection_pool:Unexpected error during pool initialization: [Errno 11001] getaddrinfo failed
ERROR:shared_libs.supabase_client.adapter:Connection failed: Failed to create database pool: [Errno 11001] getaddrinfo failed
WARNING:shared_libs.supabase_client.adapter:üîÑ Database pool failed, falling back to Supabase REST API only
INFO:shared_libs.supabase_client.adapter:‚úÖ Fallback to Supabase REST API successful
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_longterm_memory?select=user_id%2Cmemory_category%2Cmemory_data%2Cconfidence_score%2Ccreated_at%2Clast_updated&user_id=eq.%2735pDPUIfAoRl2Y700&order=confidence_score.asc "HTTP/2 200 OK"     
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_shortterm_memory?select=user_id%2Cmemory_category%2Ccontent%2Cconfidence_score%2Ccreated_at%2Cexpires_at&user_id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2&order=created_at.asc "HTTP/2 200 OK"        
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_meta_memory?select=adaptation_patterns%2Clearning_velocity%2Csuccess_predictors%2Cfailure_patterns%2Cagent_effectiveness%2Cconfidence_level%2Clast_updated&user_id=eq.%2735pDPUIfAoRl2Y700&order=confidence_level.asc "HTTP/2 200 OK"
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_analysis_results?select=id%2Cuser_id%2Canalysis_type%2Canalysis_result%2Carchetype%2Ccreated_at&user_id=eq.%2735pDPUIfAoRl2Y700&order=created_at.asc "HTTP/2 200 OK"
INFO:httpx:HTTP Request: POST https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_working_memory "HTTP/2 201 Created"
üîí [RACE_CONDITION_FIX] Using locked timestamp from OnDemandAnalysisService
üîí [RACE_CONDITION_FIX] Using locked timestamp: 2025-08-19T18:39:29.431227+00:00
ERROR:shared_libs.database.connection_pool:Unexpected error during pool initialization: [Errno 11001] getaddrinfo failed
ERROR:shared_libs.supabase_client.adapter:Connection failed: Failed to create database pool: [Errno 11001] getaddrinfo failed
WARNING:shared_libs.supabase_client.adapter:üîÑ Database pool failed, falling back to Supabase REST API only
INFO:shared_libs.supabase_client.adapter:‚úÖ Fallback to Supabase REST API successful
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/scores?select=%2A&profile_id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2&created_at=gte.2025-08-19T18%3A39%3A29.431227%2B00%3A00&order=created_at.desc&limit=1000 "HTTP/2 200 OK"
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/biomarkers?select=%2A&profile_id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2&created_at=gte.2025-08-19T18%3A39%3A29.431227%2B00%3A00&order=created_at.desc&limit=1000 "HTTP/2 200 OK"
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/archetypes?select=id%2Cprofile_id%2Cname%2Cperiodicity%2Cvalue%2Cdata%2Cstart_date_time%2Cend_date_time%2Ccreated_at%2Cupdated_at&profile_id=eq.%2735pDPUIfAoRl2Y700 "HTTP/2 200 OK"
ERROR:shared_libs.supabase_client.adapter:Query fetch failed: Invalid non-printable ASCII character in URL, '\n' at position 7.
ERROR:services.user_data_service:[STALE_CHECK] Failed to get actual latest timestamp: Invalid non-printable ASCII character in URL, '\n' at position 7.
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/profiles?select=analysis_metadata&id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2 "HTTP/2 200 OK"
INFO:httpx:HTTP Request: PATCH https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/profiles?id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2 "HTTP/2 200 OK"
ERROR:shared_libs.database.connection_pool:Unexpected error during pool initialization: [Errno 11001] getaddrinfo failed
ERROR:shared_libs.supabase_client.adapter:Connection failed: Failed to create database pool: [Errno 11001] getaddrinfo failed
WARNING:shared_libs.supabase_client.adapter:üîÑ Database pool failed, falling back to Supabase REST API only
INFO:shared_libs.supabase_client.adapter:‚úÖ Fallback to Supabase REST API successful
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_longterm_memory?select=user_id%2Cmemory_category%2Cmemory_data%2Cconfidence_score%2Ccreated_at%2Clast_updated&user_id=eq.%2735pDPUIfAoRl2Y700&order=confidence_score.asc "HTTP/2 200 OK"     
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_shortterm_memory?select=user_id%2Cmemory_category%2Ccontent%2Cconfidence_score%2Ccreated_at%2Cexpires_at&user_id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2&order=created_at.asc "HTTP/2 200 OK"        
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_meta_memory?select=adaptation_patterns%2Clearning_velocity%2Csuccess_predictors%2Cfailure_patterns%2Cagent_effectiveness%2Cconfidence_level%2Clast_updated&user_id=eq.%2735pDPUIfAoRl2Y700&order=confidence_level.asc "HTTP/2 200 OK"
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_working_memory?select=user_id%2Csession_id%2Cagent_id%2Cmemory_type%2Ccontent%2Cpriority%2Ccreated_at%2Cexpires_at&user_id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2&is_active=eq.true&order=created_at.asc "HTTP/2 200 OK"
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_analysis_results "HTTP/2 409 Conflict"
[ERROR] INSERT RETURNING failed: {'message': 'duplicate key value violates unique constraint "unique_analysis_per_user_type_date_archetype_trigger"', 'code': '23505', 'hint': None, 'details': None}
ERROR:shared_libs.supabase_client.adapter:Query fetchrow failed: {'message': 'duplicate key value violates unique constraint "unique_analysis_per_user_type_date_archetype_trigger"', 'code': '23505', 'hint': None, 'details': None}
ERROR:services.agents.memory.holistic_memory_service:[ANALYSIS_RESULTS_ERROR] Failed to store for 35pDPUIfAoRl2Y700bFkxPKYjjf2: {'message': 'duplicate key value violates unique constraint "unique_analysis_per_user_type_date_archetype_trigger"', 'code': '23505', 'hint': None, 'details': None}
INFO:httpx:HTTP Request: POST https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_shortterm_memory "HTTP/2 201 Created"
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_longterm_memory?select=id&user_id=eq.%2735pDPUIfAoRl2Y700bFkxPKYjj "HTTP/2 200 OK"
INFO:httpx:HTTP Request: POST https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_longterm_memory "HTTP/2 409 Conflict"
ERROR:shared_libs.supabase_client.adapter:Query execution failed: {'message': 'duplicate key value violates unique constraint "unique_user_memory_category"', 'code': '23505', 'hint': None, 'details': None}
ERROR:shared_libs.supabase_client.adapter:Query:
                    INSERT INTO holistic_longterm_memory (
                        user_id, memory_category, memory_data, confidence_score,
                        created_at, last_updated, update_source
                    ) VALUES ($1, $2, $3, $4, $5, $6, $7)

ERROR:shared_libs.supabase_client.adapter:Args: ('35pDPUIfAoRl2Y700bFkxPKYjjf2', 'behavioral_patterns', '{"_raw_analysis": {"behavioral_signature": {"signature": "Early-stage Peak Performer who expresses interest in optimization but has not yet established the foundational habit of consistent data capture. Current behavior is characterized by near-zero logging compliance, suggesting either technical setup issues (device not paired / app permissions) or an overly ambitious start that skipped the \\u2018baseline-building\\u2019 phase.", "confidence": 0.25}, "sophistication_assessment": {"score": 25, "category": "Beginner", "justification": "Although the archetype is Peak Performer (typically advanced), the objective evidence shows no data collection, indicating beginner-level operational sophistication in self-tracking."}, "primary_goal": {"goal": "Establish a reliable quantitative baseline for sleep, activity, and key biomarkers so advanced optimization can begin.", "timeline": "First 14 days", "success_metrics": "\\u226585 % daily device sync rate, \\u22651 sleep record per night, \\u22651 activity session logged per day, at least one complete biomarker panel within two weeks."}, "personalized_strategy": {"motivation_drivers": "Data-driven performance gains, desire for measurable improvement, enjoyment of dashboards/metrics.", "habit_integration": "1) Schedule a 10-minute nightly \\u2018data check\\u2019 to confirm devices are syncing.\\n2) Pair tracking with an existing anchoring habit (e.g., putting phone on charger = open app and verify sync).\\n3) Use immediate feedback loops\\u2014display real-time metrics on watch/home-screen widget to reinforce engagement.", "barrier_mitigation": "\\u2022 Technical: Provide step-by-step pairing guide; enable auto-sync over Wi-Fi.\\n\\u2022 Cognitive overload: Start with only two metrics (sleep duration, daily steps) before expanding.\\n\\u2022 Perfectionism: Frame baseline period as \\u2018data calibration\\u2019, not performance evaluation, to reduce drop-off from imperfect days."}, "readiness_level": "Medium", "recommendations": ["Set up and test all sensors tonight; confirm you see live heart-rate or step data in the app.", "For the next 3 mornings, record wake-time, subjective sleep quality (1-5), and resting heart rate immediately after waking.", "Enable automatic cloud backup so no data is lost if the phone battery dies.", "Book a comprehensive biomarker panel for day 12\\u201314 to complete your baseline.", "After 7 consecutive days of \\u226585 % data completeness, schedule the first advanced optimization review."], "data_insights": "No activity, sleep, or biomarker entries were detected for 2025-08-18 to 2025-08-19 (DataQualityLevel.POOR, 0 % coverage). The absence of data is the most critical insight\\u2014it prevents trend detection and indicates that establishing consistent tracking is the immediate priority.", "model_used": "o3", "analysis_type": "comprehensive_behavior"}, "_extraction_timestamp": "2025-08-19T18:40:01.571496+00:00", "_analysis_type": "behavior_analysis", "_source_model": "o3", "behavioral_signature": "Early-stage Peak Performer who expresses interest in optimization but has not yet established the foundational habit of consistent data capture. Current behavior is characterized by near-zero logging compliance, suggesting either technical setup issues (device not paired / app permissions) or an overly ambitious start that skipped the \\u2018baseline-building\\u2019 phase.", "signature_confidence": 0.25, "recommendations": ["Set up and test all sensors tonight; confirm you see live heart-rate or step data in the app.", "For the next 3 mornings, record wake-time, subjective sleep quality (1-5), and resting heart rate immediately after waking.", "Enable automatic cloud backup so no data is lost if the phone battery dies.", "Book a comprehensive biomarker panel for day 12\\u201314 to complete your baseline.", "After 7 consecutive days of \\u226585 % data completeness, schedule the first advanced optimization review."], "recommendation_count": 5, "primary_goal": {"goal": "Establish a reliable quantitative baseline for sleep, activity, and key biomarkers so advanced optimization can begin.", "timeline": "First 14 days", "success_metrics": "\\u226585 % daily device sync rate, \\u22651 sleep record per night, \\u22651 activity session logged per day, at least one complete biomarker panel within two weeks."}, "personalized_strategy": {"motivation_drivers": "Data-driven performance gains, desire for measurable improvement, enjoyment of dashboards/metrics.", "habit_integration": "1) Schedule a 10-minute nightly \\u2018data check\\u2019 to confirm devices are syncing.\\n2) Pair tracking with an existing anchoring habit (e.g., putting phone on charger = open app and verify sync).\\n3) Use immediate feedback loops\\u2014display real-time metrics on watch/home-screen widget to reinforce engagement.", "barrier_mitigation": "\\u2022 Technical: Provide step-by-step pairing guide; enable auto-sync over Wi-Fi.\\n\\u2022 Cognitive overload: Start with only two metrics (sleep duration, daily steps) before expanding.\\n\\u2022 Perfectionism: Frame baseline period as \\u2018data calibration\\u2019, not performance evaluation, to reduce drop-off from imperfect days."}, "readiness_level": "Medium", "sophistication_assessment": {"score": 25, "category": "Beginner", "justification": "Although the archetype is Peak Performer (typically advanced), the objective evidence shows no data collection, indicating beginner-level operational sophistication in self-tracking."}, "data_insights": "No activity, sleep, or biomarker entries were detected for 2025-08-18 to 2025-08-19 (DataQualityLevel.POOR, 0 % coverage). The absence of data is the most critical insight\\u2014it prevents trend detection and indicates that establishing consistent tracking is the immediate priority."}', 0.8, datetime.datetime(2025, 8, 19, 18, 40, 1, 755564, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 8, 19, 18, 40, 1, 755564, tzinfo=datetime.timezone.utc), 'memory_service')
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_meta_memory?select=id&user_id=eq.%273 "HTTP/2 200 OK"
INFO:httpx:HTTP Request: POST https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_meta_memory "HTTP/2 409 Conflict"
ERROR:shared_libs.supabase_client.adapter:Query execution failed: {'message': 'duplicate key value violates unique constraint "unique_user_meta_memory"', 'code': '23505', 'hint': None, 'details': None}
ERROR:shared_libs.supabase_client.adapter:Query:
                    INSERT INTO holistic_meta_memory (
                        user_id, adaptation_patterns, learning_velocity, success_predictors,
                        failure_patterns, agent_effectiveness, archetype_evolution, engagement_patterns,
                        created_at, last_updated, analysis_window_start, analysis_window_end
                    ) VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)
                    ON CONFLICT (user_id) DO UPDATE SET
                        adaptation_patterns = EXCLUDED.adaptation_patterns,
                        learning_velocity = EXCLUDED.learning_velocity,
                        last_updated = EXCLUDED.last_updated,
                        analysis_window_end = EXCLUDED.analysis_window_end

ERROR:shared_libs.supabase_client.adapter:Args: ('35pDPUIfAoRl2Y700bFkxPKYjjf2', '{"agents_used": ["behavior_analysis", "nutrition_plan", "routine_plan"], "complexity_provided": "low", "personalization_level": "moderate", "analysis_timestamp": "2025-08-19T18:40:02.089595+00:00"}', '{"analysis_frequency": "regular", "adaptation_speed": "moderate", "retention_indicators": {}}', '{}', '{}', '{}', '{}', '{}', datetime.datetime(2025, 8, 19, 18, 40, 2, 89618, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 8, 19, 18, 40, 2, 89618, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 7, 20, 18, 40, 2, 89618, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 8, 19, 18, 40, 2, 89618, tzinfo=datetime.timezone.utc))        
üîí [RACE_CONDITION_FIX] Added OnDemand metadata to behavior analysis result
INFO:services.api_gateway.openai_main:[SHARED_ANALYSIS] 35pDPUIf... Fresh analysis completed
üîí [RACE_CONDITION_FIX] Using locked timestamp for routine data fetch
üîí [RACE_CONDITION_FIX] Using locked timestamp: 2025-08-19T18:39:29.431227+00:00
ERROR:shared_libs.database.connection_pool:Unexpected error during pool initialization: [Errno 11001] getaddrinfo failed
ERROR:shared_libs.supabase_client.adapter:Connection failed: Failed to create database pool: [Errno 11001] getaddrinfo failed
WARNING:shared_libs.supabase_client.adapter:üîÑ Database pool failed, falling back to Supabase REST API only
INFO:shared_libs.supabase_client.adapter:‚úÖ Fallback to Supabase REST API successful
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/scores?select=%2A&profile_id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2&created_at=gte.2025-08-19T18%3A39%3A29.431227%2B00%3A00&order=created_at.desc&limit=1000 "HTTP/2 200 OK"
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/biomarkers?select=%2A&profile_id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2&created_at=gte.2025-08-19T18%3A39%3A29.431227%2B00%3A00&order=created_at.desc&limit=1000 "HTTP/2 200 OK"
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/archetypes?select=id%2Cprofile_id%2Cname%2Cperiodicity%2Cvalue%2Cdata%2Cstart_date_time%2Cend_date_time%2Ccreated_at%2Cupdated_at&profile_id=eq.%2735pDPUIfAoRl2Y700 "HTTP/2 200 OK"
ERROR:shared_libs.supabase_client.adapter:Query fetch failed: Invalid non-printable ASCII character in URL, '\n' at position 7.
ERROR:services.user_data_service:[STALE_CHECK] Failed to get actual latest timestamp: Invalid non-printable ASCII character in URL, '\n' at position 7.
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/profiles?select=analysis_metadata&id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2 "HTTP/2 200 OK"
INFO:httpx:HTTP Request: PATCH https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/profiles?id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2 "HTTP/2 200 OK"
ERROR:shared_libs.database.connection_pool:Unexpected error during pool initialization: [Errno 11001] getaddrinfo failed
ERROR:shared_libs.supabase_client.adapter:Connection failed: Failed to create database pool: [Errno 11001] getaddrinfo failed
WARNING:shared_libs.supabase_client.adapter:üîÑ Database pool failed, falling back to Supabase REST API only
INFO:shared_libs.supabase_client.adapter:‚úÖ Fallback to Supabase REST API successful
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_analysis_results?select=id%2Cuser_id%2Canalysis_type%2Canalysis_result%2Carchetype%2Ccreated_at&user_id=eq.%2735pDPUIfAoRl2Y700&order=created_at.asc "HTTP/2 200 OK"
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/profiles?select=last_analysis_at&id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2 "HTTP/2 200 OK"
‚ö†Ô∏è [MEMORY_INTEGRATION] Fallback to memory service decision: follow_up mode, 1 days
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_longterm_memory?select=user_id%2Cmemory_category%2Cmemory_data%2Cconfidence_score%2Ccreated_at%2Clast_updated&user_id=eq.%2735pDPUIfAoRl2Y700&order=confidence_score.asc "HTTP/2 200 OK"     
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_shortterm_memory?select=user_id%2Cmemory_category%2Ccontent%2Cconfidence_score%2Ccreated_at%2Cexpires_at&user_id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2&order=created_at.asc "HTTP/2 200 OK"        
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_meta_memory?select=adaptation_patterns%2Clearning_velocity%2Csuccess_predictors%2Cfailure_patterns%2Cagent_effectiveness%2Cconfidence_level%2Clast_updated&user_id=eq.%2735pDPUIfAoRl2Y700&order=confidence_level.asc "HTTP/2 200 OK"
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_analysis_results?select=id%2Cuser_id%2Canalysis_type%2Canalysis_result%2Carchetype%2Ccreated_at&user_id=eq.%2735pDPUIfAoRl2Y700&order=created_at.asc "HTTP/2 200 OK"
INFO:httpx:HTTP Request: POST https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_working_memory "HTTP/2 201 Created"
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/profiles?select=last_analysis_at&id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2 "HTTP/2 200 OK"
ERROR:shared_libs.database.connection_pool:Unexpected error during pool initialization: [Errno 11001] getaddrinfo failed
ERROR:shared_libs.supabase_client.adapter:Connection failed: Failed to create database pool: [Errno 11001] getaddrinfo failed
WARNING:shared_libs.supabase_client.adapter:üîÑ Database pool failed, falling back to Supabase REST API only
INFO:shared_libs.supabase_client.adapter:‚úÖ Fallback to Supabase REST API successful
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/scores?select=%2A&profile_id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2&created_at=gte.2025-08-19T18%3A04%3A11.097175%2B00%3A00&order=created_at.desc&limit=1000 "HTTP/2 200 OK"
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/biomarkers?select=%2A&profile_id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2&created_at=gte.2025-08-19T18%3A04%3A11.097175%2B00%3A00&order=created_at.desc&limit=1000 "HTTP/2 200 OK"
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/archetypes?select=id%2Cprofile_id%2Cname%2Cperiodicity%2Cvalue%2Cdata%2Cstart_date_time%2Cend_date_time%2Ccreated_at%2Cupdated_at&profile_id=eq.%2735pDPUIfAoRl2Y700 "HTTP/2 200 OK"
ERROR:shared_libs.supabase_client.adapter:Query fetch failed: Invalid non-printable ASCII character in URL, '\n' at position 7.
ERROR:services.user_data_service:[STALE_CHECK] Failed to get actual latest timestamp: Invalid non-printable ASCII character in URL, '\n' at position 7.
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/profiles?select=analysis_metadata&id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2 "HTTP/2 200 OK"
INFO:httpx:HTTP Request: PATCH https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/profiles?id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2 "HTTP/2 200 OK"
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_longterm_memory?select=user_id%2Cmemory_category%2Cmemory_data%2Cconfidence_score%2Ccreated_at%2Clast_updated&user_id=eq.%2735pDPUIfAoRl2Y700&order=confidence_score.asc "HTTP/2 200 OK"     
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_shortterm_memory?select=user_id%2Cmemory_category%2Ccontent%2Cconfidence_score%2Ccreated_at%2Cexpires_at&user_id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2&order=created_at.asc "HTTP/2 200 OK"        
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_meta_memory?select=adaptation_patterns%2Clearning_velocity%2Csuccess_predictors%2Cfailure_patterns%2Cagent_effectiveness%2Cconfidence_level%2Clast_updated&user_id=eq.%2735pDPUIfAoRl2Y700&order=confidence_level.asc "HTTP/2 200 OK"
ERROR:shared_libs.database.connection_pool:Unexpected error during pool initialization: [Errno 11001] getaddrinfo failed
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/archetype_analysis_tracking?select=last_analysis_at&user_id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2&archetype=eq.Foundation+Builder "HTTP/2 200 OK"
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/scores?select=id&profile_id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2&created_at=gte.2025-08-19T18%3A38%3A06.606346%2B00%3A00 "HTTP/2 200 OK"
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/biomarkers?select=id&profile_id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2&created_at=gte.2025-08-19T18%3A38%3A06.606346%2B00%3A00 "HTTP/2 200 OK"
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_longterm_memory?select=user_id%2Cmemory_category%2Cmemory_data%2Cconfidence_score%2Ccreated_at%2Clast_updated&user_id=eq.%2735pDPUIfAoRl2Y700&order=confidence_score.asc "HTTP/2 200 OK"     
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_analysis_results?select=id%2Cuser_id%2Canalysis_type%2Canalysis_result%2Carchetype%2Ccreated_at&user_id=eq.%2735pDPUIfAoRl2Y700&order=created_at.asc "HTTP/2 200 OK"
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_meta_memory?select=adaptation_patterns%2Clearning_velocity%2Csuccess_predictors%2Cfailure_patterns%2Cagent_effectiveness%2Cconfidence_level%2Clast_updated&user_id=eq.%2735pDPUIfAoRl2Y700&order=confidence_level.asc "HTTP/2 200 OK"
üíæ [BEHAVIOR_ANALYZE] Using cached analysis (below threshold)
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_analysis_results?select=id%2Cuser_id%2Canalysis_type%2Canalysis_result%2Carchetype%2Ccreated_at&user_id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2&analysis_type=eq.%27behavior&order=created_at.asc "HTTP/2 200 OK"
INFO:services.ondemand_analysis_service:[ONDEMAND] No cached analysis found for archetype 'Foundation Builder' for user 35pDPUIf
INFO:httpx:HTTP Request: GET https://api.openai.com/v1/models "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/archetype_analysis_tracking?select=last_analysis_at&user_id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2&archetype=eq.Peak+Performer "HTTP/2 200 OK"
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/scores?select=id&profile_id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2&created_at=gte.2025-08-19T18%3A39%3A29.431227%2B00%3A00 "HTTP/2 200 OK"
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/biomarkers?select=id&profile_id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2&created_at=gte.2025-08-19T18%3A39%3A29.431227%2B00%3A00 "HTTP/2 200 OK"
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_longterm_memory?select=user_id%2Cmemory_category%2Cmemory_data%2Cconfidence_score%2Ccreated_at%2Clast_updated&user_id=eq.%2735pDPUIfAoRl2Y700&order=confidence_score.asc "HTTP/2 200 OK"     
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_analysis_results?select=id%2Cuser_id%2Canalysis_type%2Canalysis_result%2Carchetype%2Ccreated_at&user_id=eq.%2735pDPUIfAoRl2Y700&order=created_at.asc "HTTP/2 200 OK"
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_meta_memory?select=adaptation_patterns%2Clearning_velocity%2Csuccess_predictors%2Cfailure_patterns%2Cagent_effectiveness%2Cconfidence_level%2Clast_updated&user_id=eq.%2735pDPUIfAoRl2Y700&order=confidence_level.asc "HTTP/2 200 OK"
üíæ [BEHAVIOR_ANALYZE] Using cached analysis (below threshold)
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_analysis_results?select=id%2Cuser_id%2Canalysis_type%2Canalysis_result%2Carchetype%2Ccreated_at&user_id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2&analysis_type=eq.%27behavior&order=created_at.asc "HTTP/2 200 OK"
INFO:services.ondemand_analysis_service:[ONDEMAND] No cached analysis found for archetype 'Peak Performer' for user 35pDPUIf
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_analysis_results "HTTP/2 201 Created"
INFO:httpx:HTTP Request: POST https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_insights "HTTP/2 201 Created"
‚úÖ [INSIGHTS_LOGGER] Successfully logged 1 insights (Analysis #1)
   üìÑ Added to: logs/output_1.txt
   üìã Created: logs/insights_1.txt
INFO:services.insights_extraction_service:Extracted and stored 1 insights from routine_plan 
INFO:httpx:HTTP Request: POST https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_shortterm_memory "HTTP/2 201 Created"
ERROR:shared_libs.database.connection_pool:Unexpected error during pool initialization: [Errno 11001] getaddrinfo failed
ERROR:shared_libs.supabase_client.adapter:Connection failed: Failed to create database pool: [Errno 11001] getaddrinfo failed
WARNING:shared_libs.supabase_client.adapter:üîÑ Database pool failed, falling back to Supabase REST API only
INFO:shared_libs.supabase_client.adapter:‚úÖ Fallback to Supabase REST API successful
INFO:httpx:HTTP Request: POST https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_analysis_results "HTTP/2 409 Conflict"
[ERROR] INSERT RETURNING failed: {'message': 'duplicate key value violates unique constraint "unique_analysis_per_user_type_date_archetype_trigger"', 'code': '23505', 'hint': None, 'details': None}
ERROR:shared_libs.supabase_client.adapter:Query fetchrow failed: {'message': 'duplicate key value violates unique constraint "unique_analysis_per_user_type_date_archetype_trigger"', 'code': '23505', 'hint': None, 'details': None}
ERROR:services.agents.memory.holistic_memory_service:[ANALYSIS_RESULTS_ERROR] Failed to store for 35pDPUIfAoRl2Y700bFkxPKYjjf2: {'message': 'duplicate key value violates unique constraint "unique_analysis_per_user_type_date_archetype_trigger"', 'code': '23505', 'hint': None, 'details': None}
WARNING:shared_libs.rate_limiting.rate_limiter:Redis unavailable - cannot track cost: user=35pDPUIfAoRl2Y700bFkxPKYjjf2, endpoint=routine_generation, cost=$0.0200
WARNING:shared_libs.rate_limiting.middleware:Slow request: POST /api/user/35pDPUIfAoRl2Y700bFkxPKYjjf2/routine/generate took 105.53s
ERROR:shared_libs.database.connection_pool:Unexpected error during pool initialization: [Errno 11001] getaddrinfo failed
INFO:httpx:HTTP Request: GET https://api.openai.com/v1/models "HTTP/1.1 200 OK"
CRITICAL:shared_libs.monitoring.alerting:ALERT [CRITICAL] system: System Critical Issues Detected | critical_issues=['database: Database error: Failed to create database pool: [Errno 11001] getaddrinfo failed'], environment=production, timestamp=2025-08-19T14:43:21.445745, affected_services=1
ERROR:shared_libs.database.connection_pool:Unexpected error during pool initialization: [Errno 11001] getaddrinfo failed
INFO:httpx:HTTP Request: GET https://api.openai.com/v1/models "HTTP/1.1 200 OK"
ERROR:shared_libs.database.connection_pool:Unexpected error during pool initialization: [Errno 11001] getaddrinfo failed
INFO:httpx:HTTP Request: GET https://api.openai.com/v1/models "HTTP/1.1 200 OK"
ERROR:shared_libs.monitoring.alerting:ALERT [ERROR] database: Database Service Critical | service=database, error_message=Database error: Failed to create database pool: [Errno 11001] getaddrinfo failed, response_time_ms=-1, details={}
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/archetype_analysis_tracking?select=last_analysis_at&user_id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2&archetype=eq.Peak+Performer "HTTP/2 200 OK"
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/scores?select=id&profile_id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2&created_at=gte.2025-08-19T18%3A39%3A29.431227%2B00%3A00 "HTTP/2 200 OK"
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/biomarkers?select=id&profile_id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2&created_at=gte.2025-08-19T18%3A39%3A29.431227%2B00%3A00 "HTTP/2 200 OK"
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_longterm_memory?select=user_id%2Cmemory_category%2Cmemory_data%2Cconfidence_score%2Ccreated_at%2Clast_updated&user_id=eq.%2735pDPUIfAoRl2Y700&order=confidence_score.asc "HTTP/2 200 OK"     
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_analysis_results?select=id%2Cuser_id%2Canalysis_type%2Canalysis_result%2Carchetype%2Ccreated_at&user_id=eq.%2735pDPUIfAoRl2Y700&order=created_at.asc "HTTP/2 200 OK"
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_meta_memory?select=adaptation_patterns%2Clearning_velocity%2Csuccess_predictors%2Cfailure_patterns%2Cagent_effectiveness%2Cconfidence_level%2Clast_updated&user_id=eq.%2735pDPUIfAoRl2Y700&order=confidence_level.asc "HTTP/2 200 OK"
ERROR:shared_libs.database.connection_pool:Unexpected error during pool initialization: [Errno 11001] getaddrinfo failed
ERROR:shared_libs.supabase_client.adapter:Connection failed: Failed to create database pool: [Errno 11001] getaddrinfo failed
WARNING:shared_libs.supabase_client.adapter:üîÑ Database pool failed, falling back to Supabase REST API only
INFO:shared_libs.supabase_client.adapter:‚úÖ Fallback to Supabase REST API successful
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_longterm_memory?select=user_id%2Cmemory_category%2Cmemory_data%2Cconfidence_score%2Ccreated_at%2Clast_updated&user_id=eq.%2735pDPUIfAoRl2Y700&order=confidence_score.asc "HTTP/2 200 OK"     
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_shortterm_memory?select=user_id%2Cmemory_category%2Ccontent%2Cconfidence_score%2Ccreated_at%2Cexpires_at&user_id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2&order=created_at.asc "HTTP/2 200 OK"        
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_meta_memory?select=adaptation_patterns%2Clearning_velocity%2Csuccess_predictors%2Cfailure_patterns%2Cagent_effectiveness%2Cconfidence_level%2Clast_updated&user_id=eq.%2735pDPUIfAoRl2Y700&order=confidence_level.asc "HTTP/2 200 OK"
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_analysis_results?select=id%2Cuser_id%2Canalysis_type%2Canalysis_result%2Carchetype%2Ccreated_at&user_id=eq.%2735pDPUIfAoRl2Y700&order=created_at.asc "HTTP/2 200 OK"
INFO:httpx:HTTP Request: POST https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_working_memory "HTTP/2 201 Created"
üîí [RACE_CONDITION_FIX] Using locked timestamp from OnDemandAnalysisService
üîí [RACE_CONDITION_FIX] Using locked timestamp: 2025-08-19T18:39:29.431227+00:00
ERROR:shared_libs.database.connection_pool:Unexpected error during pool initialization: [Errno 11001] getaddrinfo failed
ERROR:shared_libs.supabase_client.adapter:Connection failed: Failed to create database pool: [Errno 11001] getaddrinfo failed
WARNING:shared_libs.supabase_client.adapter:üîÑ Database pool failed, falling back to Supabase REST API only
INFO:shared_libs.supabase_client.adapter:‚úÖ Fallback to Supabase REST API successful
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/scores?select=%2A&profile_id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2&created_at=gte.2025-08-19T18%3A39%3A29.431227%2B00%3A00&order=created_at.desc&limit=1000 "HTTP/2 200 OK"
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/biomarkers?select=%2A&profile_id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2&created_at=gte.2025-08-19T18%3A39%3A29.431227%2B00%3A00&order=created_at.desc&limit=1000 "HTTP/2 200 OK"
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/archetypes?select=id%2Cprofile_id%2Cname%2Cperiodicity%2Cvalue%2Cdata%2Cstart_date_time%2Cend_date_time%2Ccreated_at%2Cupdated_at&profile_id=eq.%2735pDPUIfAoRl2Y700 "HTTP/2 200 OK"
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/profiles?select=analysis_metadata&id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2 "HTTP/2 200 OK"
INFO:httpx:HTTP Request: PATCH https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/profiles?id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2 "HTTP/2 200 OK"
ERROR:shared_libs.database.connection_pool:Unexpected error during pool initialization: [Errno 11001] getaddrinfo failed
ERROR:shared_libs.supabase_client.adapter:Connection failed: Failed to create database pool: [Errno 11001] getaddrinfo failed
WARNING:shared_libs.supabase_client.adapter:üîÑ Database pool failed, falling back to Supabase REST API only
INFO:shared_libs.supabase_client.adapter:‚úÖ Fallback to Supabase REST API successful
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_longterm_memory?select=user_id%2Cmemory_category%2Cmemory_data%2Cconfidence_score%2Ccreated_at%2Clast_updated&user_id=eq.%2735pDPUIfAoRl2Y700&order=confidence_score.asc "HTTP/2 200 OK"     
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_shortterm_memory?select=user_id%2Cmemory_category%2Ccontent%2Cconfidence_score%2Ccreated_at%2Cexpires_at&user_id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2&order=created_at.asc "HTTP/2 200 OK"        
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_meta_memory?select=adaptation_patterns%2Clearning_velocity%2Csuccess_predictors%2Cfailure_patterns%2Cagent_effectiveness%2Cconfidence_level%2Clast_updated&user_id=eq.%2735pDPUIfAoRl2Y700&order=confidence_level.asc "HTTP/2 200 OK"
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_working_memory?select=user_id%2Csession_id%2Cagent_id%2Cmemory_type%2Ccontent%2Cpriority%2Ccreated_at%2Cexpires_at&user_id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2&is_active=eq.true&order=created_at.asc "HTTP/2 200 OK"
ERROR:shared_libs.database.connection_pool:Unexpected error during pool initialization: [Errno 11001] getaddrinfo failed
INFO:httpx:HTTP Request: GET https://api.openai.com/v1/models "HTTP/1.1 200 OK"
CRITICAL:shared_libs.monitoring.alerting:ALERT [CRITICAL] system: System Critical Issues Detected | critical_issues=['database: Database error: Failed to create database pool: [Errno 11001] getaddrinfo failed'], environment=production, timestamp=2025-08-19T14:49:31.235488, affected_services=1
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_analysis_results "HTTP/2 409 Conflict"
[ERROR] INSERT RETURNING failed: {'message': 'duplicate key value violates unique constraint "unique_analysis_per_user_type_date_archetype_trigger"', 'code': '23505', 'hint': None, 'details': None}
ERROR:shared_libs.supabase_client.adapter:Query fetchrow failed: {'message': 'duplicate key value violates unique constraint "unique_analysis_per_user_type_date_archetype_trigger"', 'code': '23505', 'hint': None, 'details': None}
ERROR:services.agents.memory.holistic_memory_service:[ANALYSIS_RESULTS_ERROR] Failed to store for 35pDPUIfAoRl2Y700bFkxPKYjjf2: {'message': 'duplicate key value violates unique constraint "unique_analysis_per_user_type_date_archetype_trigger"', 'code': '23505', 'hint': None, 'details': None}
INFO:httpx:HTTP Request: POST https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_shortterm_memory "HTTP/2 201 Created"
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_longterm_memory?select=id&user_id=eq.%2735pDPUIfAoRl2Y700bFkxPKYjj "HTTP/2 200 OK"
INFO:httpx:HTTP Request: POST https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_longterm_memory "HTTP/2 409 Conflict"
ERROR:shared_libs.supabase_client.adapter:Query execution failed: {'message': 'duplicate key value violates unique constraint "unique_user_memory_category"', 'code': '23505', 'hint': None, 'details': None}
ERROR:shared_libs.supabase_client.adapter:Query:
                    INSERT INTO holistic_longterm_memory (
                        user_id, memory_category, memory_data, confidence_score,
                        created_at, last_updated, update_source
                    ) VALUES ($1, $2, $3, $4, $5, $6, $7)

ERROR:shared_libs.supabase_client.adapter:Args: ('35pDPUIfAoRl2Y700bFkxPKYjjf2', 'behavioral_patterns', '{"_raw_analysis": {"behavioral_signature": {"signature": "New Peak Performer profile displaying high engagement with activity (29 logged sessions in 48 h) and solid sleep quality (Sleep Score \\u2248 0.79) but only moderate physiological readiness (0.56). This suggests a high-drive, data-conscious user who is willing to push physical output but has not yet built a calibrated recovery rhythm. Early signs of balanced mental well-being (0.84) indicate good psychological resilience, while readiness lag points to a small recovery deficit\\u2014typical of Peak Performers who front-load effort before dialing in recovery systems.", "confidence": 0.65}, "sophistication_assessment": {"score": 72, "category": "Advanced", "justification": "EXCELLENT data quality, full 100 % coverage, and granular tracking across sleep, readiness, activity, and mental domains show advanced self-monitoring competence. However, lack of longitudinal baselines and only one biomarker data point per metric place overall sophistication below \\u2018Expert\\u2019 for now."}, "primary_goal": {"goal": "Elevate physiological readiness to match high activity output without sacrificing performance gains.", "timeline": "4\\u20136 weeks to raise average Readiness Score from 0.56 \\u279c \\u2265 0.75 and sustain it for two consecutive weeks.", "success_metrics": "\\u2022 7-day rolling Readiness \\u2265 0.75\\n\\u2022 Subjective energy and focus \\u2265 8/10 on daily check-ins\\n\\u2022 No drop (>5 %) in Activity Score while readiness rises\\n\\u2022 HRV trending upward (\\u2265 5 % over baseline)"}, "personalized_strategy": {"motivation_drivers": "Quantifiable progress, competitive self-benchmarking, curiosity for optimization experiments.", "habit_integration": "1. AM 3-min readiness review \\u279c auto-adjust training load.\\n2. Evening shutdown routine (same start time \\u00b115 min) to cement sleep regularity.\\n3. Weekly \\u2018data audit\\u2019 session to visualize correlations (sleep vs. readiness).", "barrier_mitigation": "\\u2022 Over-training risk \\u279c schedule one active-recovery day after any two successive high-load days.\\n\\u2022 Data fatigue \\u279c automate dashboards; surface only one key daily metric (readiness delta).\\n\\u2022 Perfectionism \\u279c set \\u2018experimentation windows\\u2019 (2-week sprints) to avoid constant protocol tweaking."}, "readiness_level": "Medium", "recommendations": ["Adopt HRV-guided training: If morning readiness <0.60, cut high-intensity volume by 30 % and add 10 min mobility + breath work.", "Anchor sleep start time: Target lights-out at consistent 22:30; early data show 1-h variability\\u2014tighten to \\u00b115 min.", "Introduce 15-min parasympathetic \\u2018micro-recovery\\u2019 block (box-breathing or 4-7-8) post-lunch to improve afternoon HRV.", "Log pre-sleep nutrition; minimize heavy protein/fat meals <2 h before bed\\u2014track any readiness change.", "Schedule a weekly deload (every 7th day) with \\u2264 50 % usual training load and \\u2265 8 000 low-intensity steps.", "Run a 2-week A/B test: compare magnesium glycinate (400 mg) supplementation vs. control on sleep latency and next-day readiness."], "data_insights": "Across two days, Sleep and Activity Scores are high (0.79, 0.88) indicating adequate duration (exact sleep duration ~7 h based on single data point) and strong movement engagement (steps + active minutes both logged). Mental Well-being sits at 0.84, aligning with Peak Performer psychology of high cognitive drive. Readiness lag (0.56) despite good sleep points to either cumulative load or insufficient recovery modalities. High Activity Sedentary Duration is low (good), yet medium-intensity activity is present, suggesting balanced training intensity. The immediate priority is to compress sleep timing variance and insert deliberate recovery to close the readiness gap.", "model_used": "o3", "analysis_type": "comprehensive_behavior"}, "_extraction_timestamp": "2025-08-19T18:49:32.001248+00:00", "_analysis_type": "behavior_analysis", "_source_model": "o3", "behavioral_signature": "New Peak Performer profile displaying high engagement with activity (29 logged sessions in 48 h) and solid sleep quality (Sleep Score \\u2248 0.79) but only moderate physiological readiness (0.56). This suggests a high-drive, data-conscious user who is willing to push physical output but has not yet built a calibrated recovery rhythm. Early signs of balanced mental well-being (0.84) indicate good psychological resilience, while readiness lag points to a small recovery deficit\\u2014typical of Peak Performers who front-load effort before dialing in recovery systems.", "signature_confidence": 0.65, "recommendations": ["Adopt HRV-guided training: If morning readiness <0.60, cut high-intensity volume by 30 % and add 10 min mobility + breath work.", "Anchor sleep start time: Target lights-out at consistent 22:30; early data show 1-h variability\\u2014tighten to \\u00b115 min.", "Introduce 15-min parasympathetic \\u2018micro-recovery\\u2019 block (box-breathing or 4-7-8) post-lunch to improve afternoon HRV.", "Log pre-sleep nutrition; minimize heavy protein/fat meals <2 h before bed\\u2014track any readiness change.", "Schedule a weekly deload (every 7th day) with \\u2264 50 % usual training load and \\u2265 8 000 low-intensity steps.", "Run a 2-week A/B test: compare magnesium glycinate (400 mg) supplementation vs. control on sleep latency and next-day readiness."], "recommendation_count": 6, "primary_goal": {"goal": "Elevate physiological readiness to match high activity output without sacrificing performance gains.", "timeline": "4\\u20136 weeks to raise average Readiness Score from 0.56 \\u279c \\u2265 0.75 and sustain it for two consecutive weeks.", "success_metrics": "\\u2022 7-day rolling Readiness \\u2265 0.75\\n\\u2022 Subjective energy and focus \\u2265 8/10 on daily check-ins\\n\\u2022 No drop (>5 %) in Activity Score while readiness rises\\n\\u2022 HRV trending upward (\\u2265 5 % over baseline)"}, "personalized_strategy": {"motivation_drivers": "Quantifiable progress, competitive self-benchmarking, curiosity for optimization experiments.", "habit_integration": "1. AM 3-min readiness review \\u279c auto-adjust training load.\\n2. Evening shutdown routine (same start time \\u00b115 min) to cement sleep regularity.\\n3. Weekly \\u2018data audit\\u2019 session to visualize correlations (sleep vs. readiness).", "barrier_mitigation": "\\u2022 Over-training risk \\u279c schedule one active-recovery day after any two successive high-load days.\\n\\u2022 Data fatigue \\u279c automate dashboards; surface only one key daily metric (readiness delta).\\n\\u2022 Perfectionism \\u279c set \\u2018experimentation windows\\u2019 (2-week sprints) to avoid constant protocol tweaking."}, "readiness_level": "Medium", "sophistication_assessment": {"score": 72, "category": "Advanced", "justification": "EXCELLENT data quality, full 100 % coverage, and granular tracking across sleep, readiness, activity, and mental domains show advanced self-monitoring competence. However, lack of longitudinal baselines and only one biomarker data point per metric place overall sophistication below \\u2018Expert\\u2019 for now."}, "data_insights": "Across two days, Sleep and Activity Scores are high (0.79, 0.88) indicating adequate duration (exact sleep duration ~7 h based on single data point) and strong movement engagement (steps + active minutes both logged). Mental Well-being sits at 0.84, aligning with Peak Performer psychology of high cognitive drive. Readiness lag (0.56) despite good sleep points to either cumulative load or insufficient recovery modalities. High Activity Sedentary Duration is low (good), yet medium-intensity activity is present, suggesting balanced training intensity. The immediate priority is to compress sleep timing variance and insert deliberate recovery to close the readiness gap."}', 0.8, datetime.datetime(2025, 8, 19, 18, 49, 32, 336656, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 8, 19, 18, 49, 32, 336656, tzinfo=datetime.timezone.utc), 'memory_service')
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_meta_memory?select=id&user_id=eq.%273 "HTTP/2 200 OK"
INFO:httpx:HTTP Request: POST https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_meta_memory "HTTP/2 409 Conflict"
ERROR:shared_libs.supabase_client.adapter:Query execution failed: {'message': 'duplicate key value violates unique constraint "unique_user_meta_memory"', 'code': '23505', 'hint': None, 'details': None}
ERROR:shared_libs.supabase_client.adapter:Query:
                    INSERT INTO holistic_meta_memory (
                        user_id, adaptation_patterns, learning_velocity, success_predictors,
                        failure_patterns, agent_effectiveness, archetype_evolution, engagement_patterns,
                        created_at, last_updated, analysis_window_start, analysis_window_end
                    ) VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)
                    ON CONFLICT (user_id) DO UPDATE SET
                        adaptation_patterns = EXCLUDED.adaptation_patterns,
                        learning_velocity = EXCLUDED.learning_velocity,
                        last_updated = EXCLUDED.last_updated,
                        analysis_window_end = EXCLUDED.analysis_window_end

ERROR:shared_libs.supabase_client.adapter:Args: ('35pDPUIfAoRl2Y700bFkxPKYjjf2', '{"agents_used": ["behavior_analysis", "nutrition_plan", "routine_plan"], "complexity_provided": "low", "personalization_level": "low", "analysis_timestamp": "2025-08-19T18:49:32.490646+00:00"}', '{"analysis_frequency": "regular", "adaptation_speed": "moderate", "retention_indicators": {}}', '{}', '{}', '{}', '{}', '{}', datetime.datetime(2025, 8, 19, 18, 49, 32, 490668, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 8, 19, 18, 49, 32, 490668, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 7, 20, 18, 49, 32, 490668, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 8, 19, 18, 49, 32, 490668, tzinfo=datetime.timezone.utc))     
üîí [RACE_CONDITION_FIX] Added OnDemand metadata to behavior analysis result
INFO:services.api_gateway.openai_main:[SHARED_ANALYSIS] 35pDPUIf... Fresh analysis completed
üîí [RACE_CONDITION_FIX] Using locked timestamp for routine data fetch
üîí [RACE_CONDITION_FIX] Using locked timestamp: 2025-08-19T18:39:29.431227+00:00
ERROR:shared_libs.database.connection_pool:Unexpected error during pool initialization: [Errno 11001] getaddrinfo failed
ERROR:shared_libs.supabase_client.adapter:Connection failed: Failed to create database pool: [Errno 11001] getaddrinfo failed
WARNING:shared_libs.supabase_client.adapter:üîÑ Database pool failed, falling back to Supabase REST API only
INFO:shared_libs.supabase_client.adapter:‚úÖ Fallback to Supabase REST API successful
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/scores?select=%2A&profile_id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2&created_at=gte.2025-08-19T18%3A39%3A29.431227%2B00%3A00&order=created_at.desc&limit=1000 "HTTP/2 200 OK"
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/biomarkers?select=%2A&profile_id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2&created_at=gte.2025-08-19T18%3A39%3A29.431227%2B00%3A00&order=created_at.desc&limit=1000 "HTTP/2 200 OK"
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/archetypes?select=id%2Cprofile_id%2Cname%2Cperiodicity%2Cvalue%2Cdata%2Cstart_date_time%2Cend_date_time%2Ccreated_at%2Cupdated_at&profile_id=eq.%2735pDPUIfAoRl2Y700 "HTTP/2 200 OK"
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/profiles?select=analysis_metadata&id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2 "HTTP/2 200 OK"
INFO:httpx:HTTP Request: PATCH https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/profiles?id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2 "HTTP/2 200 OK"
ERROR:shared_libs.database.connection_pool:Unexpected error during pool initialization: [Errno 11001] getaddrinfo failed
ERROR:shared_libs.supabase_client.adapter:Connection failed: Failed to create database pool: [Errno 11001] getaddrinfo failed
WARNING:shared_libs.supabase_client.adapter:üîÑ Database pool failed, falling back to Supabase REST API only
INFO:shared_libs.supabase_client.adapter:‚úÖ Fallback to Supabase REST API successful
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_analysis_results?select=id%2Cuser_id%2Canalysis_type%2Canalysis_result%2Carchetype%2Ccreated_at&user_id=eq.%2735pDPUIfAoRl2Y700&order=created_at.asc "HTTP/2 200 OK"
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/profiles?select=last_analysis_at&id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2 "HTTP/2 200 OK"
‚ö†Ô∏è [MEMORY_INTEGRATION] Fallback to memory service decision: follow_up mode, 1 days
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_longterm_memory?select=user_id%2Cmemory_category%2Cmemory_data%2Cconfidence_score%2Ccreated_at%2Clast_updated&user_id=eq.%2735pDPUIfAoRl2Y700&order=confidence_score.asc "HTTP/2 200 OK"     
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_shortterm_memory?select=user_id%2Cmemory_category%2Ccontent%2Cconfidence_score%2Ccreated_at%2Cexpires_at&user_id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2&order=created_at.asc "HTTP/2 200 OK"        
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_meta_memory?select=adaptation_patterns%2Clearning_velocity%2Csuccess_predictors%2Cfailure_patterns%2Cagent_effectiveness%2Cconfidence_level%2Clast_updated&user_id=eq.%2735pDPUIfAoRl2Y700&order=confidence_level.asc "HTTP/2 200 OK"
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_analysis_results?select=id%2Cuser_id%2Canalysis_type%2Canalysis_result%2Carchetype%2Ccreated_at&user_id=eq.%2735pDPUIfAoRl2Y700&order=created_at.asc "HTTP/2 200 OK"
INFO:httpx:HTTP Request: POST https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_working_memory "HTTP/2 201 Created"
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/profiles?select=last_analysis_at&id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2 "HTTP/2 200 OK"
ERROR:shared_libs.database.connection_pool:Unexpected error during pool initialization: [Errno 11001] getaddrinfo failed
ERROR:shared_libs.supabase_client.adapter:Connection failed: Failed to create database pool: [Errno 11001] getaddrinfo failed
WARNING:shared_libs.supabase_client.adapter:üîÑ Database pool failed, falling back to Supabase REST API only
INFO:shared_libs.supabase_client.adapter:‚úÖ Fallback to Supabase REST API successful
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/scores?select=%2A&profile_id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2&created_at=gte.2025-08-19T18%3A04%3A11.097175%2B00%3A00&order=created_at.desc&limit=1000 "HTTP/2 200 OK"
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/biomarkers?select=%2A&profile_id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2&created_at=gte.2025-08-19T18%3A04%3A11.097175%2B00%3A00&order=created_at.desc&limit=1000 "HTTP/2 200 OK"
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/archetypes?select=id%2Cprofile_id%2Cname%2Cperiodicity%2Cvalue%2Cdata%2Cstart_date_time%2Cend_date_time%2Ccreated_at%2Cupdated_at&profile_id=eq.%2735pDPUIfAoRl2Y700 "HTTP/2 200 OK"
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/profiles?select=analysis_metadata&id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2 "HTTP/2 200 OK"
INFO:httpx:HTTP Request: PATCH https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/profiles?id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2 "HTTP/2 200 OK"
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_longterm_memory?select=user_id%2Cmemory_category%2Cmemory_data%2Cconfidence_score%2Ccreated_at%2Clast_updated&user_id=eq.%2735pDPUIfAoRl2Y700&order=confidence_score.asc "HTTP/2 200 OK"     
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_shortterm_memory?select=user_id%2Cmemory_category%2Ccontent%2Cconfidence_score%2Ccreated_at%2Cexpires_at&user_id=eq.35pDPUIfAoRl2Y700bFkxPKYjjf2&order=created_at.asc "HTTP/2 200 OK"        
INFO:httpx:HTTP Request: GET https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_meta_memory?select=adaptation_patterns%2Clearning_velocity%2Csuccess_predictors%2Cfailure_patterns%2Cagent_effectiveness%2Cconfidence_level%2Clast_updated&user_id=eq.%2735pDPUIfAoRl2Y700&order=confidence_level.asc "HTTP/2 200 OK"
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_analysis_results "HTTP/2 409 Conflict"
[ERROR] INSERT RETURNING failed: {'message': 'duplicate key value violates unique constraint "unique_analysis_per_user_type_date_archetype_trigger"', 'code': '23505', 'hint': None, 'details': None}
ERROR:shared_libs.supabase_client.adapter:Query fetchrow failed: {'message': 'duplicate key value violates unique constraint "unique_analysis_per_user_type_date_archetype_trigger"', 'code': '23505', 'hint': None, 'details': None}
ERROR:services.agents.memory.holistic_memory_service:[ANALYSIS_RESULTS_ERROR] Failed to store for 35pDPUIfAoRl2Y700bFkxPKYjjf2: {'message': 'duplicate key value violates unique constraint "unique_analysis_per_user_type_date_archetype_trigger"', 'code': '23505', 'hint': None, 'details': None}
INFO:httpx:HTTP Request: POST https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_shortterm_memory "HTTP/2 201 Created"
ERROR:shared_libs.database.connection_pool:Unexpected error during pool initialization: [Errno 11001] getaddrinfo failed
ERROR:shared_libs.supabase_client.adapter:Connection failed: Failed to create database pool: [Errno 11001] getaddrinfo failed
WARNING:shared_libs.supabase_client.adapter:üîÑ Database pool failed, falling back to Supabase REST API only
INFO:shared_libs.supabase_client.adapter:‚úÖ Fallback to Supabase REST API successful
INFO:httpx:HTTP Request: POST https://ijcckqnqruwvqqbkiubb.supabase.co/rest/v1/holistic_analysis_results "HTTP/2 409 Conflict"
[ERROR] INSERT RETURNING failed: {'message': 'duplicate key value violates unique constraint "unique_analysis_per_user_type_date_archetype_trigger"', 'code': '23505', 'hint': None, 'details': None}
ERROR:shared_libs.supabase_client.adapter:Query fetchrow failed: {'message': 'duplicate key value violates unique constraint "unique_analysis_per_user_type_date_archetype_trigger"', 'code': '23505', 'hint': None, 'details': None}
ERROR:services.agents.memory.holistic_memory_service:[ANALYSIS_RESULTS_ERROR] Failed to store for 35pDPUIfAoRl2Y700bFkxPKYjjf2: {'message': 'duplicate key value violates unique constraint "unique_analysis_per_user_type_date_archetype_trigger"', 'code': '23505', 'hint': None, 'details': None}
WARNING:shared_libs.rate_limiting.rate_limiter:Redis unavailable - cannot track cost: user=35pDPUIfAoRl2Y700bFkxPKYjjf2, endpoint=routine_generation, cost=$0.0200
WARNING:shared_libs.rate_limiting.middleware:Slow request: POST /api/user/35pDPUIfAoRl2Y700bFkxPKYjjf2/routine/generate took 101.97s
ERROR:shared_libs.database.connection_pool:Unexpected error during pool initialization: [Errno 11001] getaddrinfo failed
INFO:httpx:HTTP Request: GET https://api.openai.com/v1/models "HTTP/1.1 200 OK"
ERROR:shared_libs.database.connection_pool:Unexpected error during pool initialization: [Errno 11001] getaddrinfo failed
INFO:httpx:HTTP Request: GET https://api.openai.com/v1/models "HTTP/1.1 200 OK"
ERROR:shared_libs.database.connection_pool:Unexpected error during pool initialization: [Errno 11001] getaddrinfo failed
INFO:httpx:HTTP Request: GET https://api.openai.com/v1/models "HTTP/1.1 200 OK"
CRITICAL:shared_libs.monitoring.alerting:ALERT [CRITICAL] system: System Critical Issues Detected | critical_issues=['database: Database error: Failed to create database pool: [Errno 11001] getaddrinfo failed'], environment=production, timestamp=2025-08-19T14:55:41.108625, affected_services=1
ERROR:shared_libs.database.connection_pool:Unexpected error during pool initialization: [Errno 11001] getaddrinfo failed
INFO:httpx:HTTP Request: GET https://api.openai.com/v1/models "HTTP/1.1 200 OK"
ERROR:shared_libs.monitoring.alerting:ALERT [ERROR] database: Database Service Critical | service=database, error_message=Database error: Failed to create database pool: [Errno 11001] getaddrinfo failed, response_time_ms=-1, details={}
